<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('../partials/MainHeader.ejs') %>
</head>

<body>
    <div class="container-xxl position-relative bg-white d-flex p-0">
        <!-- Spinner Start -->
        <%- include('../partials/spinner.ejs') %>
            <!-- Spinner End -->


            <!-- Sidebar Start -->
            <%- include('../partials/adminSidebar.ejs')%>
                <!-- Sidebar End -->


                <!-- Content Start -->
                <div class="content">
                    <!-- Navbar Start -->
                    <%- include('../partials/navbar.ejs')%>
                        <!-- Navbar End -->

                        <div class="col-sm-12 col-xl-12 pt-4 px-4">
                            <%- include("../partials/flashMessage.ejs") %>
                        </div>

                        <div class="col-sm-12 col-xl-12 pt-4 px-4 d-md-flex gap-4 justify-content-between">
                            <div class="bg-light rounded shadow-sm h-100 p-4 mb-2 flex-grow-1">
                                <h6 class="mb-4 fw-bold text-primary">Upload Gallery Images</h6>

                                <form action="/admin/image-gallery" method="POST" enctype="multipart/form-data">

                                    <!-- File Upload -->
                                    <div class="mb-3">
                                        <label for="images" class="form-label">Select Images</label>
                                        <input class="form-control" type="file" id="images" name="images" multiple
                                            accept="image/*">
                                        <div class="form-text">You can select multiple images at once.</div>
                                    </div>

                                    <!-- Preview (optional, Bootstrap only) -->
                                    <div id="preview" class="d-flex flex-wrap gap-2 mb-3"></div>

                                    <!-- Submit Button -->
                                    <button type="submit" class="btn btn-primary w-100">Upload</button>
                                </form>
                            </div>
                        </div>

                        <!-- Blank Start -->
                        <div class="container-fluid pt-4 px-4">
                            <div class="row bg-light rounded justify-content-center m-0 p-2" style="min-height: 70vh;">
                                <div class="container mt-4">
                                    <h3 class="mb-4">Uploaded Images (<%= data.gallery.length %>)</h3>

                                    <div class="row">
                                        <% if (data.gallery && data.gallery.length> 0) { %>
                                            <% data.gallery.forEach(function(image) { %>
                                                <div class="col-md-3 col-sm-6 mb-4">
                                                    <div class="card position-relative shadow-sm border-0">
                                                        <!-- Image -->
                                                        <img src="<%= image.url %>"
                                                            class="card-img-top img-fluid rounded"
                                                            style="object-fit: cover; height: 200px;">

                                                        <!-- Top-right overlay icons -->
                                                        <div class="position-absolute top-0 end-0 m-2 d-flex gap-2">
                                                            <!-- View Icon -->
                                                            <a href="<%= image.url %>" target="_blank"
                                                                class="btn btn-sm btn-light shadow-sm"
                                                                data-bs-toggle="tooltip" title="View Fullscreen">
                                                                <i class="fas fa-eye"></i>
                                                            </a>
                                                            <!-- Delete Icon -->
                                                            <form action="/admin/image-gallery/delete/<%= image._id %>"
                                                                method="POST"
                                                                onsubmit="return confirm('Are you sure you want to delete this image?')">
                                                                <button type="submit"
                                                                    class="btn btn-sm btn-danger shadow-sm"
                                                                    data-bs-toggle="tooltip" title="Delete">
                                                                    <i class="fas fa-trash"></i>
                                                                </button>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                                <% }) %>
                                                    <% } else { %>
                                                        <div class="col-12">
                                                            <p class="text-muted">No images uploaded yet.</p>
                                                        </div>
                                                        <% } %>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Blank End -->


                        <!-- Footer Start -->
                        <%- include('../partials/MainFooter.ejs')%>
                            <!-- Footer End -->





                </div>
                <!-- Content End -->



                <!-- Back to Top -->
                <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a>
    </div>


    <!-- JavaScript Libraries -->
    <%- include('../partials/MainJSLibrary.ejs')%>
        <!-- Optional: Bootstrap-only Preview (no external CSS) -->
        <script>
            document.getElementById("images").addEventListener("change", function () {
                const preview = document.getElementById("preview");
                preview.innerHTML = ""; // clear old previews

                [...this.files].forEach(file => {
                    const reader = new FileReader();
                    reader.onload = e => {
                        const img = document.createElement("img");
                        img.src = e.target.result;
                        img.className = "img-thumbnail";
                        img.style.height = "100px";
                        preview.appendChild(img);
                    };
                    reader.readAsDataURL(file);
                });
            });
        </script>

</body>

</html>